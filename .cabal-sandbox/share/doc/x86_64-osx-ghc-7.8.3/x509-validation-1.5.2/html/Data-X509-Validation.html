<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Data.X509.Validation</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Data-X509-Validation.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">x509-validation-1.5.2: X.509 Certificate and CRL validation</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>License</th><td>BSD-style</td></tr><tr><th>Maintainer</th><td>Vincent Hanquez &lt;vincent@snarc.org&gt;</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>unknown</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell98</td></tr></table><p class="caption">Data.X509.Validation</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Failed validation types</a></li><li><a href="#g:2">Validation configuration types</a></li><li><a href="#g:3">Validation</a></li><li><a href="#g:4">Cache</a></li><li><a href="#g:5">Cache for validation</a></li><li><a href="#g:6">Simple instances of cache mechanism</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>X.509 Certificate checks and validations routines</p><p>Follows RFC5280 / RFC6818</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type</span> <a href="#t:ServiceID">ServiceID</a> = (<a href="Data-X509-Validation.html#t:HostName">HostName</a>, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.4.0/Data-ByteString.html#t:ByteString">ByteString</a>)</li><li class="src short"><span class="keyword">type</span> <a href="#t:HostName">HostName</a> = <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-String.html#t:String">String</a></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:Fingerprint">Fingerprint</a> = <a href="#v:Fingerprint">Fingerprint</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.4.0/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:FailedReason">FailedReason</a><ul class="subs"><li>= <a href="#v:UnknownCriticalExtension">UnknownCriticalExtension</a></li><li>| <a href="#v:Expired">Expired</a></li><li>| <a href="#v:InFuture">InFuture</a></li><li>| <a href="#v:SelfSigned">SelfSigned</a></li><li>| <a href="#v:UnknownCA">UnknownCA</a></li><li>| <a href="#v:NotAllowedToSign">NotAllowedToSign</a></li><li>| <a href="#v:NotAnAuthority">NotAnAuthority</a></li><li>| <a href="#v:AuthorityTooDeep">AuthorityTooDeep</a></li><li>| <a href="#v:NoCommonName">NoCommonName</a></li><li>| <a href="#v:InvalidName">InvalidName</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-String.html#t:String">String</a></li><li>| <a href="#v:NameMismatch">NameMismatch</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-String.html#t:String">String</a></li><li>| <a href="#v:InvalidWildcard">InvalidWildcard</a></li><li>| <a href="#v:LeafKeyUsageNotAllowed">LeafKeyUsageNotAllowed</a></li><li>| <a href="#v:LeafKeyPurposeNotAllowed">LeafKeyPurposeNotAllowed</a></li><li>| <a href="#v:LeafNotV3">LeafNotV3</a></li><li>| <a href="#v:EmptyChain">EmptyChain</a></li><li>| <a href="#v:CacheSaysNo">CacheSaysNo</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-String.html#t:String">String</a></li><li>| <a href="#v:InvalidSignature">InvalidSignature</a> <a href="Data-X509-Validation.html#t:SignatureFailure">SignatureFailure</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:SignatureFailure">SignatureFailure</a><ul class="subs"><li>= <a href="#v:SignatureInvalid">SignatureInvalid</a></li><li>| <a href="#v:SignaturePubkeyMismatch">SignaturePubkeyMismatch</a></li><li>| <a href="#v:SignatureUnimplemented">SignatureUnimplemented</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:ValidationChecks">ValidationChecks</a> = <a href="#v:ValidationChecks">ValidationChecks</a> {<ul class="subs"><li><a href="#v:checkTimeValidity">checkTimeValidity</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></li><li><a href="#v:checkAtTime">checkAtTime</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/hourglass-0.2.9/html/Data-Hourglass-Types.html#t:DateTime">DateTime</a></li><li><a href="#v:checkStrictOrdering">checkStrictOrdering</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></li><li><a href="#v:checkCAConstraints">checkCAConstraints</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></li><li><a href="#v:checkExhaustive">checkExhaustive</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></li><li><a href="#v:checkLeafV3">checkLeafV3</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></li><li><a href="#v:checkLeafKeyUsage">checkLeafKeyUsage</a> :: [<a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:ExtKeyUsageFlag">ExtKeyUsageFlag</a>]</li><li><a href="#v:checkLeafKeyPurpose">checkLeafKeyPurpose</a> :: [<a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:ExtKeyUsagePurpose">ExtKeyUsagePurpose</a>]</li><li><a href="#v:checkFQHN">checkFQHN</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:ValidationHooks">ValidationHooks</a> = <a href="#v:ValidationHooks">ValidationHooks</a> {<ul class="subs"><li><a href="#v:hookMatchSubjectIssuer">hookMatchSubjectIssuer</a> :: <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:DistinguishedName">DistinguishedName</a> -&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:Certificate">Certificate</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></li><li><a href="#v:hookValidateTime">hookValidateTime</a> :: <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/hourglass-0.2.9/html/Data-Hourglass-Types.html#t:DateTime">DateTime</a> -&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:Certificate">Certificate</a> -&gt; [<a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a>]</li><li><a href="#v:hookValidateName">hookValidateName</a> :: <a href="Data-X509-Validation.html#t:HostName">HostName</a> -&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:Certificate">Certificate</a> -&gt; [<a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a>]</li><li><a href="#v:hookFilterReason">hookFilterReason</a> :: [<a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a>] -&gt; [<a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a>]</li></ul>}</li><li class="src short"><a href="#v:defaultChecks">defaultChecks</a> :: <a href="Data-X509-Validation.html#t:ValidationChecks">ValidationChecks</a></li><li class="src short"><a href="#v:defaultHooks">defaultHooks</a> :: <a href="Data-X509-Validation.html#t:ValidationHooks">ValidationHooks</a></li><li class="src short"><a href="#v:validate">validate</a> :: <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:HashALG">HashALG</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationHooks">ValidationHooks</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationChecks">ValidationChecks</a> -&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-store-1.5.0/html/Data-X509-CertificateStore.html#t:CertificateStore">CertificateStore</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationCache">ValidationCache</a> -&gt; <a href="Data-X509-Validation.html#t:ServiceID">ServiceID</a> -&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:CertificateChain">CertificateChain</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> [<a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a>]</li><li class="src short"><a href="#v:validateDefault">validateDefault</a> :: <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-store-1.5.0/html/Data-X509-CertificateStore.html#t:CertificateStore">CertificateStore</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationCache">ValidationCache</a> -&gt; <a href="Data-X509-Validation.html#t:ServiceID">ServiceID</a> -&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:CertificateChain">CertificateChain</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> [<a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a>]</li><li class="src short"><a href="#v:getFingerprint">getFingerprint</a> :: (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Text-Show.html#t:Show">Show</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Eq.html#t:Eq">Eq</a> a, <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/asn1-encoding-0.9.0/html/Data-ASN1-Object.html#t:ASN1Object">ASN1Object</a> a) =&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:SignedExact">SignedExact</a> a -&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:HashALG">HashALG</a> -&gt; <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:ValidationCacheResult">ValidationCacheResult</a><ul class="subs"><li>= <a href="#v:ValidationCachePass">ValidationCachePass</a></li><li>| <a href="#v:ValidationCacheDenied">ValidationCacheDenied</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-String.html#t:String">String</a></li><li>| <a href="#v:ValidationCacheUnknown">ValidationCacheUnknown</a></li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:ValidationCacheQueryCallback">ValidationCacheQueryCallback</a> = <a href="Data-X509-Validation.html#t:ServiceID">ServiceID</a> -&gt; <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a> -&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:Certificate">Certificate</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> <a href="Data-X509-Validation.html#t:ValidationCacheResult">ValidationCacheResult</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:ValidationCacheAddCallback">ValidationCacheAddCallback</a> = <a href="Data-X509-Validation.html#t:ServiceID">ServiceID</a> -&gt; <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a> -&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:Certificate">Certificate</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><span class="keyword">data</span> <a href="#t:ValidationCache">ValidationCache</a> = <a href="#v:ValidationCache">ValidationCache</a> {<ul class="subs"><li><a href="#v:cacheQuery">cacheQuery</a> :: <a href="Data-X509-Validation.html#t:ValidationCacheQueryCallback">ValidationCacheQueryCallback</a></li><li><a href="#v:cacheAdd">cacheAdd</a> :: <a href="Data-X509-Validation.html#t:ValidationCacheAddCallback">ValidationCacheAddCallback</a></li></ul>}</li><li class="src short"><a href="#v:exceptionValidationCache">exceptionValidationCache</a> :: [(<a href="Data-X509-Validation.html#t:ServiceID">ServiceID</a>, <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a>)] -&gt; <a href="Data-X509-Validation.html#t:ValidationCache">ValidationCache</a></li><li class="src short"><a href="#v:tofuValidationCache">tofuValidationCache</a> :: [(<a href="Data-X509-Validation.html#t:ServiceID">ServiceID</a>, <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a>)] -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> <a href="Data-X509-Validation.html#t:ValidationCache">ValidationCache</a></li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:ServiceID" class="def">ServiceID</a> = (<a href="Data-X509-Validation.html#t:HostName">HostName</a>, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.4.0/Data-ByteString.html#t:ByteString">ByteString</a>)</p><div class="doc"><p>identification of the connection consisting of the
 fully qualified host name (e.g. www.example.com) and
 an optional suffix.</p><p>The suffix is not used by the validation process, but
 is used by the optional cache to identity certificate per service
 on a specific host. For example, one might have a different
 certificate on 2 differents ports (443 and 995) for the same host.</p><p>for TCP connection, it's recommended to use: :port, or :service for the suffix.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:HostName" class="def">HostName</a> = <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-String.html#t:String">String</a></p><div class="doc"><p>Either a host name e.g., <code>&quot;haskell.org&quot;</code> or a numeric host
 address string consisting of a dotted decimal IPv4 address or an
 IPv6 address e.g., <code>&quot;192.168.0.1&quot;</code>.</p></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a name="t:Fingerprint" class="def">Fingerprint</a></p><div class="doc"><p>Fingerprint of a certificate</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Fingerprint" class="def">Fingerprint</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.4.0/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Fingerprint" class="caption collapser" onclick="toggleSection('i:Fingerprint')">Instances</p><div id="section.i:Fingerprint" class="show"><table><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Eq.html#t:Eq">Eq</a> <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Text-Show.html#t:Show">Show</a> <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/byteable-0.1.1/html/Data-Byteable.html#t:Byteable">Byteable</a> <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:1">Failed validation types</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:FailedReason" class="def">FailedReason</a></p><div class="doc"><p>Possible reason of certificate and chain failure</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:UnknownCriticalExtension" class="def">UnknownCriticalExtension</a></td><td class="doc"><p>certificate contains an unknown critical extension</p></td></tr><tr><td class="src"><a name="v:Expired" class="def">Expired</a></td><td class="doc"><p>validity ends before checking time</p></td></tr><tr><td class="src"><a name="v:InFuture" class="def">InFuture</a></td><td class="doc"><p>validity starts after checking time</p></td></tr><tr><td class="src"><a name="v:SelfSigned" class="def">SelfSigned</a></td><td class="doc"><p>certificate is self signed</p></td></tr><tr><td class="src"><a name="v:UnknownCA" class="def">UnknownCA</a></td><td class="doc"><p>unknown Certificate Authority (CA)</p></td></tr><tr><td class="src"><a name="v:NotAllowedToSign" class="def">NotAllowedToSign</a></td><td class="doc"><p>certificate is not allowed to sign</p></td></tr><tr><td class="src"><a name="v:NotAnAuthority" class="def">NotAnAuthority</a></td><td class="doc"><p>not a CA</p></td></tr><tr><td class="src"><a name="v:AuthorityTooDeep" class="def">AuthorityTooDeep</a></td><td class="doc"><p>Violation of the optional Basic constraint's path length</p></td></tr><tr><td class="src"><a name="v:NoCommonName" class="def">NoCommonName</a></td><td class="doc"><p>Certificate doesn't have any common name (CN)</p></td></tr><tr><td class="src"><a name="v:InvalidName" class="def">InvalidName</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-String.html#t:String">String</a></td><td class="doc"><p>Invalid name in certificate</p></td></tr><tr><td class="src"><a name="v:NameMismatch" class="def">NameMismatch</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-String.html#t:String">String</a></td><td class="doc"><p>connection name and certificate do not match</p></td></tr><tr><td class="src"><a name="v:InvalidWildcard" class="def">InvalidWildcard</a></td><td class="doc"><p>invalid wildcard in certificate</p></td></tr><tr><td class="src"><a name="v:LeafKeyUsageNotAllowed" class="def">LeafKeyUsageNotAllowed</a></td><td class="doc"><p>the requested key usage is not compatible with the leaf certificate's key usage</p></td></tr><tr><td class="src"><a name="v:LeafKeyPurposeNotAllowed" class="def">LeafKeyPurposeNotAllowed</a></td><td class="doc"><p>the requested key purpose is not compatible with the leaf certificate's extended key usage</p></td></tr><tr><td class="src"><a name="v:LeafNotV3" class="def">LeafNotV3</a></td><td class="doc"><p>Only authorized an X509.V3 certificate as leaf certificate.</p></td></tr><tr><td class="src"><a name="v:EmptyChain" class="def">EmptyChain</a></td><td class="doc"><p>empty chain of certificate</p></td></tr><tr><td class="src"><a name="v:CacheSaysNo" class="def">CacheSaysNo</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-String.html#t:String">String</a></td><td class="doc"><p>the cache explicitely denied this certificate</p></td></tr><tr><td class="src"><a name="v:InvalidSignature" class="def">InvalidSignature</a> <a href="Data-X509-Validation.html#t:SignatureFailure">SignatureFailure</a></td><td class="doc"><p>signature failed</p></td></tr></table></div><div class="subs instances"><p id="control.i:FailedReason" class="caption collapser" onclick="toggleSection('i:FailedReason')">Instances</p><div id="section.i:FailedReason" class="show"><table><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Eq.html#t:Eq">Eq</a> <a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Text-Show.html#t:Show">Show</a> <a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:SignatureFailure" class="def">SignatureFailure</a></p><div class="doc"><p>Various failure possible during signature checking</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:SignatureInvalid" class="def">SignatureInvalid</a></td><td class="doc"><p>signature doesn't verify</p></td></tr><tr><td class="src"><a name="v:SignaturePubkeyMismatch" class="def">SignaturePubkeyMismatch</a></td><td class="doc"><p>algorithm and public key mismatch, cannot proceed</p></td></tr><tr><td class="src"><a name="v:SignatureUnimplemented" class="def">SignatureUnimplemented</a></td><td class="doc"><p>unimplemented signature algorithm</p></td></tr></table></div><div class="subs instances"><p id="control.i:SignatureFailure" class="caption collapser" onclick="toggleSection('i:SignatureFailure')">Instances</p><div id="section.i:SignatureFailure" class="show"><table><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Eq.html#t:Eq">Eq</a> <a href="Data-X509-Validation.html#t:SignatureFailure">SignatureFailure</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Text-Show.html#t:Show">Show</a> <a href="Data-X509-Validation.html#t:SignatureFailure">SignatureFailure</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:2">Validation configuration types</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ValidationChecks" class="def">ValidationChecks</a></p><div class="doc"><p>A set of checks to activate or parametrize to perform on certificates.</p><p>It's recommended to use <code><a href="Data-X509-Validation.html#v:defaultChecks">defaultChecks</a></code> to create the structure,
 to better cope with future changes or expansion of the structure.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ValidationChecks" class="def">ValidationChecks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:checkTimeValidity" class="def">checkTimeValidity</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></dt><dd class="doc"><p>check time validity of every certificate in the chain.
 the make sure that current time is between each validity bounds
 in the certificate</p></dd><dt class="src"><a name="v:checkAtTime" class="def">checkAtTime</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/hourglass-0.2.9/html/Data-Hourglass-Types.html#t:DateTime">DateTime</a></dt><dd class="doc"><p>The time when the validity check happens. When set to Nothing,
 the current time will be used</p></dd><dt class="src"><a name="v:checkStrictOrdering" class="def">checkStrictOrdering</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></dt><dd class="doc"><p>Check that no certificate is included that shouldn't be included.
 unfortunately despite the specification violation, a lots of
 real world server serves useless and usually old certificates
 that are not relevant to the certificate sent, in their chain.</p></dd><dt class="src"><a name="v:checkCAConstraints" class="def">checkCAConstraints</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></dt><dd class="doc"><p>Check that signing certificate got the CA basic constraint.
 this is absolutely not recommended to turn it off.</p></dd><dt class="src"><a name="v:checkExhaustive" class="def">checkExhaustive</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></dt><dd class="doc"><p>Check the whole certificate chain without stopping at the first failure.
 Allow gathering a exhaustive list of failure reasons. if this is
 turn off, it's absolutely not safe to ignore a failed reason even it doesn't look serious
 (e.g. Expired) as other more serious checks would not have been performed.</p></dd><dt class="src"><a name="v:checkLeafV3" class="def">checkLeafV3</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></dt><dd class="doc"><p>Check that the leaf certificate is version 3. If disable, version 2 certificate
 is authorized in leaf position and key usage cannot be checked.</p></dd><dt class="src"><a name="v:checkLeafKeyUsage" class="def">checkLeafKeyUsage</a> :: [<a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:ExtKeyUsageFlag">ExtKeyUsageFlag</a>]</dt><dd class="doc"><p>Check that the leaf certificate is authorized to be used for certain usage.
 If set to empty list no check are performed, otherwise all the flags is the list
 need to exists in the key usage extension. If the extension is not present,
 the check will pass and behave as if the certificate key is not restricted to
 any specific usage.</p></dd><dt class="src"><a name="v:checkLeafKeyPurpose" class="def">checkLeafKeyPurpose</a> :: [<a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:ExtKeyUsagePurpose">ExtKeyUsagePurpose</a>]</dt><dd class="doc"><p>Check that the leaf certificate is authorized to be used for certain purpose.
 If set to empty list no check are performed, otherwise all the flags is the list
 need to exists in the extended key usage extension if present. If the extension is not
 present, then the check will pass and behave as if the certificate is not restricted
 to any specific purpose.</p></dd><dt class="src"><a name="v:checkFQHN" class="def">checkFQHN</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></dt><dd class="doc"><p>Check the top certificate names matching the fully qualified hostname (FQHN).
 it's not recommended to turn this check off, if no other name checks are performed.</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:ValidationChecks" class="caption collapser" onclick="toggleSection('i:ValidationChecks')">Instances</p><div id="section.i:ValidationChecks" class="show"><table><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Eq.html#t:Eq">Eq</a> <a href="Data-X509-Validation.html#t:ValidationChecks">ValidationChecks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Text-Show.html#t:Show">Show</a> <a href="Data-X509-Validation.html#t:ValidationChecks">ValidationChecks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/data-default-class-0.0.1/html/Data-Default-Class.html#t:Default">Default</a> <a href="Data-X509-Validation.html#t:ValidationChecks">ValidationChecks</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ValidationHooks" class="def">ValidationHooks</a></p><div class="doc"><p>A set of hooks to manipulate the way the verification works.</p><p>BEWARE, it's easy to change behavior leading to compromised security.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ValidationHooks" class="def">ValidationHooks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:hookMatchSubjectIssuer" class="def">hookMatchSubjectIssuer</a> :: <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:DistinguishedName">DistinguishedName</a> -&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:Certificate">Certificate</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></dt><dd class="doc"><p>check the the issuer <code><a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:DistinguishedName">DistinguishedName</a></code> match the subject <code><a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:DistinguishedName">DistinguishedName</a></code>
 of a certificate.</p></dd><dt class="src"><a name="v:hookValidateTime" class="def">hookValidateTime</a> :: <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/hourglass-0.2.9/html/Data-Hourglass-Types.html#t:DateTime">DateTime</a> -&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:Certificate">Certificate</a> -&gt; [<a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a>]</dt><dd class="doc"><p>validate that the parametrized time valide with the certificate in argument</p></dd><dt class="src"><a name="v:hookValidateName" class="def">hookValidateName</a> :: <a href="Data-X509-Validation.html#t:HostName">HostName</a> -&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:Certificate">Certificate</a> -&gt; [<a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a>]</dt><dd class="doc"><p>validate the certificate leaf name with the DNS named used to connect</p></dd><dt class="src"><a name="v:hookFilterReason" class="def">hookFilterReason</a> :: [<a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a>] -&gt; [<a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a>]</dt><dd class="doc"><p>user filter to modify the list of failure reasons</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:ValidationHooks" class="caption collapser" onclick="toggleSection('i:ValidationHooks')">Instances</p><div id="section.i:ValidationHooks" class="show"><table><tr><td class="src"><a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/data-default-class-0.0.1/html/Data-Default-Class.html#t:Default">Default</a> <a href="Data-X509-Validation.html#t:ValidationHooks">ValidationHooks</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:defaultChecks" class="def">defaultChecks</a> :: <a href="Data-X509-Validation.html#t:ValidationChecks">ValidationChecks</a></p><div class="doc"><p>Default checks to perform</p><p>The default checks are:
 * Each certificate time is valid
 * CA constraints is enforced for signing certificate
 * Leaf certificate is X.509 v3
 * Check that the FQHN match</p></div></div><div class="top"><p class="src"><a name="v:defaultHooks" class="def">defaultHooks</a> :: <a href="Data-X509-Validation.html#t:ValidationHooks">ValidationHooks</a></p><div class="doc"><p>Default hooks in the validation process</p></div></div><h1 id="g:3">Validation</h1><div class="top"><p class="src"><a name="v:validate" class="def">validate</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:HashALG">HashALG</a></td><td class="doc"><p>the hash algorithm we want to use for hashing the leaf certificate</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ValidationHooks">ValidationHooks</a></td><td class="doc"><p>Hooks to use</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ValidationChecks">ValidationChecks</a></td><td class="doc"><p>Checks to do</p></td></tr><tr><td class="src">-&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-store-1.5.0/html/Data-X509-CertificateStore.html#t:CertificateStore">CertificateStore</a></td><td class="doc"><p>The trusted certificate store for CA</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ValidationCache">ValidationCache</a></td><td class="doc"><p>the validation cache callbacks</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ServiceID">ServiceID</a></td><td class="doc"><p>identification of the connection</p></td></tr><tr><td class="src">-&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:CertificateChain">CertificateChain</a></td><td class="doc"><p>the certificate chain we want to validate</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> [<a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a>]</td><td class="doc"><p>the return failed reasons (empty list is no failure)</p></td></tr></table></div><div class="doc"><p>X509 validation</p><p>the function first interrogate the cache and if the validation fail,
 proper verification is done. If the verification pass, the
 add to cache callback is called.</p></div></div><div class="top"><p class="src"><a name="v:validateDefault" class="def">validateDefault</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-store-1.5.0/html/Data-X509-CertificateStore.html#t:CertificateStore">CertificateStore</a></td><td class="doc"><p>The trusted certificate store for CA</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ValidationCache">ValidationCache</a></td><td class="doc"><p>the validation cache callbacks</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ServiceID">ServiceID</a></td><td class="doc"><p>identification of the connection</p></td></tr><tr><td class="src">-&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:CertificateChain">CertificateChain</a></td><td class="doc"><p>the certificate chain we want to validate</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> [<a href="Data-X509-Validation.html#t:FailedReason">FailedReason</a>]</td><td class="doc"><p>the return failed reasons (empty list is no failure)</p></td></tr></table></div><div class="doc"><p>Validate using the default hooks and checks and the SHA256 mechanism as hashing mechanism</p></div></div><div class="top"><p class="src"><a name="v:getFingerprint" class="def">getFingerprint</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Text-Show.html#t:Show">Show</a> a, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Eq.html#t:Eq">Eq</a> a, <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/asn1-encoding-0.9.0/html/Data-ASN1-Object.html#t:ASN1Object">ASN1Object</a> a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:SignedExact">SignedExact</a> a</td><td class="doc"><p>object to fingerprint</p></td></tr><tr><td class="src">-&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:HashALG">HashALG</a></td><td class="doc"><p>algorithm to compute the fingerprint</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a></td><td class="doc"><p>fingerprint in binary form</p></td></tr></table></div><div class="doc"><p>Get the fingerprint of the whole signed object
 using the hashing algorithm specified</p></div></div><h1 id="g:4">Cache</h1><h1 id="g:5">Cache for validation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ValidationCacheResult" class="def">ValidationCacheResult</a></p><div class="doc"><p>The result of a cache query</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ValidationCachePass" class="def">ValidationCachePass</a></td><td class="doc"><p>cache allow this fingerprint to go through</p></td></tr><tr><td class="src"><a name="v:ValidationCacheDenied" class="def">ValidationCacheDenied</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-String.html#t:String">String</a></td><td class="doc"><p>cache denied this fingerprint for further validation</p></td></tr><tr><td class="src"><a name="v:ValidationCacheUnknown" class="def">ValidationCacheUnknown</a></td><td class="doc"><p>unknown fingerprint in cache</p></td></tr></table></div><div class="subs instances"><p id="control.i:ValidationCacheResult" class="caption collapser" onclick="toggleSection('i:ValidationCacheResult')">Instances</p><div id="section.i:ValidationCacheResult" class="show"><table><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Eq.html#t:Eq">Eq</a> <a href="Data-X509-Validation.html#t:ValidationCacheResult">ValidationCacheResult</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Text-Show.html#t:Show">Show</a> <a href="Data-X509-Validation.html#t:ValidationCacheResult">ValidationCacheResult</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:ValidationCacheQueryCallback" class="def">ValidationCacheQueryCallback</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">&nbsp;= <a href="Data-X509-Validation.html#t:ServiceID">ServiceID</a></td><td class="doc"><p>connection's identification</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a></td><td class="doc"><p>fingerprint of the leaf certificate</p></td></tr><tr><td class="src">-&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:Certificate">Certificate</a></td><td class="doc"><p>leaf certificate</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> <a href="Data-X509-Validation.html#t:ValidationCacheResult">ValidationCacheResult</a></td><td class="doc"><p>return if the operation is succesful or not</p></td></tr></table></div><div class="doc"><p>Validation cache query callback type</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:ValidationCacheAddCallback" class="def">ValidationCacheAddCallback</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">&nbsp;= <a href="Data-X509-Validation.html#t:ServiceID">ServiceID</a></td><td class="doc"><p>connection's identification</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a></td><td class="doc"><p>fingerprint of the leaf certificate</p></td></tr><tr><td class="src">-&gt; <a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/x509-1.5.0.1/html/Data-X509.html#t:Certificate">Certificate</a></td><td class="doc"><p>leaf certificate</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Validation cache callback type</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ValidationCache" class="def">ValidationCache</a></p><div class="doc"><p>All the callbacks needed for querying and adding to the cache.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ValidationCache" class="def">ValidationCache</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:cacheQuery" class="def">cacheQuery</a> :: <a href="Data-X509-Validation.html#t:ValidationCacheQueryCallback">ValidationCacheQueryCallback</a></dt><dd class="doc"><p>cache querying callback</p></dd><dt class="src"><a name="v:cacheAdd" class="def">cacheAdd</a> :: <a href="Data-X509-Validation.html#t:ValidationCacheAddCallback">ValidationCacheAddCallback</a></dt><dd class="doc"><p>cache adding callback</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:ValidationCache" class="caption collapser" onclick="toggleSection('i:ValidationCache')">Instances</p><div id="section.i:ValidationCache" class="show"><table><tr><td class="src"><a href="file:///Users/toddmohney/workspace/pivotal_tracker_radiator/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.8.3/data-default-class-0.0.1/html/Data-Default-Class.html#t:Default">Default</a> <a href="Data-X509-Validation.html#t:ValidationCache">ValidationCache</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:6">Simple instances of cache mechanism</h1><div class="top"><p class="src"><a name="v:exceptionValidationCache" class="def">exceptionValidationCache</a> :: [(<a href="Data-X509-Validation.html#t:ServiceID">ServiceID</a>, <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a>)] -&gt; <a href="Data-X509-Validation.html#t:ValidationCache">ValidationCache</a></p><div class="doc"><p>create a simple constant cache that list exceptions to the certification
 validation. Typically this is use to allow self-signed certificates for
 specific use, with out-of-bounds user checks.</p><p>No fingerprints will be added after the instance is created.</p><p>The underlying structure for the check is kept as a list, as
 usually the exception list will be short, but when the list go above
 a dozen exceptions it's recommended to use another cache mechanism with
 a faster lookup mechanism (hashtable, map, etc).</p><p>Note that only one fingerprint is allowed per ServiceID, for other use,
 another cache mechanism need to be use.</p></div></div><div class="top"><p class="src"><a name="v:tofuValidationCache" class="def">tofuValidationCache</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="Data-X509-Validation.html#t:ServiceID">ServiceID</a>, <a href="Data-X509-Validation.html#t:Fingerprint">Fingerprint</a>)]</td><td class="doc"><p>a list of exceptions</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> <a href="Data-X509-Validation.html#t:ValidationCache">ValidationCache</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Trust on first use (TOFU) cache with an optional list of exceptions</p><p>this is similar to the exceptionCache, except that after
 each succesfull validation it does add the fingerprint
 to the database. This prevent any further modification of the
 fingerprint for the remaining</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.14.3</p></div></body></html>